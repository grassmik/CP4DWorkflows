<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:flowable="http://flowable.org/bpmn" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI" typeLanguage="http://www.w3.org/2001/XMLSchema" expressionLanguage="http://www.w3.org/1999/XPath" targetNamespace="https://dataplatform.cloud.ibm.com/workflows/requests/two_step_approval_and_review">
  <signal id="cancelReview" name="cancelReview" flowable:scope="global"></signal>
  <signal id="updateArtifact" name="updateArtifact" flowable:scope="global"></signal>
  <process id="two_step_approval_and_review_key_v2" name="Two step approval and review" isExecutable="true">
    <documentation>Affie v6 two step approval and review step documentation/description</documentation>
    <startEvent id="startevent1" name="Start" flowable:formFieldValidation="true">
      <extensionElements>
        <flowable:formProperty id="publishing_step_mode" type="enum" readable="false">
          <flowable:value id="auto_action" name="Automatically publish artifacts. Skip publishing approval."></flowable:value>
          <flowable:value id="explicit_action" name=""></flowable:value>
        </flowable:formProperty>
      </extensionElements>
    </startEvent>
    <sequenceFlow id="authoringFlow" name="author" sourceRef="exclusivegateway4" targetRef="scripttask10"></sequenceFlow>
    <exclusiveGateway id="exclusivegateway1" name="Excl. Gateway 1" default="discardflow"></exclusiveGateway>
    <callActivity id="callpublish" name="Call publish step" calledElement="publishStep" flowable:calledElementType="key" flowable:fallbackToDefaultTenant="false">
      <extensionElements>
        <flowable:in source="publishing_step_mode" target="publishing_step_mode"></flowable:in>
        <flowable:in source="due_date" target="due_date"></flowable:in>
        <flowable:in source="workflow_config_id" target="workflow_config_id"></flowable:in>
        <flowable:in sourceExpression="{&quot;id&quot;:&quot;wkc-governance-workflows.default.approval.actionButton.approve&quot;, &quot;defaultMessage&quot;:&quot;Approve&quot;}" target="action"></flowable:in>
        <flowable:in source="comment" target="comment"></flowable:in>
        <flowable:out source="action" target="action"></flowable:out>
        <flowable:out source="comment" target="comment"></flowable:out>
      </extensionElements>
    </callActivity>
    <sequenceFlow id="sendforapprovalFlow" name="send for approval" sourceRef="exclusivegateway1" targetRef="scripttask11">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${action == 'sendforapproval'}]]></conditionExpression>
    </sequenceFlow>
    <endEvent id="endevent2" name="End"></endEvent>
    <sequenceFlow id="discardflow" name="discard" sourceRef="exclusivegateway1" targetRef="scripttask2"></sequenceFlow>
    <sequenceFlow id="flow5" sourceRef="startevent1" targetRef="scripttask9"></sequenceFlow>
    <scriptTask id="scripttask2" name="Discard" scriptFormat="javascript" flowable:autoStoreVariables="false">
      <script><![CDATA[scriptLogger.info(execution, execution.getProcessDefinitionId() + ': action ' + action + ' comment ' + comment + ' due date ' + due_date);
// workflowStateAndActionLogger.updateWorkflowState(execution, 'Discarded', '{"id":"wkc-governance-workflows.default.authoring.actionButton.discard", "defaultMessage":"Delete draft"}', false, comment, null);

try {
	draftActionBean.discard(execution);
	scriptLogger.info(execution, "Draft discarded");
}
catch (e) {
	scriptLogger.error(execution, "Error discarding draft: " + e);
	throw e;
}
]]></script>
    </scriptTask>
    <sequenceFlow id="flow6" sourceRef="scripttask2" targetRef="endevent2"></sequenceFlow>
    <scriptTask id="scripttask3" name="prep approval" scriptFormat="javascript" flowable:autoStoreVariables="false">
      <script><![CDATA[execution.setTransientVariableLocal('workflow_action', 'Approve');
var workflow_action_instruction = 'approve or reject';
var draft_verb_lookup = {'CREATE': 'created', 'MODIFY': 'updated', 'DELETE': 'marked for deletion', 'IMPORT_CREATE': 'imported', 'IMPORT_MODIFY': 'imported'};
var draft_verb = draft_verb_lookup[draft_mode] || draft_mode;
var task_instructions = null;
var default_task_instructions = null;
var default_task_title = null;
if (isPluralText) {
  task_instructions = task_context + ' and then ' + workflow_action_instruction + ' all of them together.';
  default_task_instructions = '§<USERID:{userId}> ' + draft_verb + ' these {artifactTypePlural}. Review each {artifactType} and then ' + workflow_action_instruction + ' all of them together.';
  default_task_title = workflow_action + ' {artifactTypePlural}';
  execution.setTransientVariableLocal('one_or_many', 'many');
} else {
  task_instructions = task_context + ' and then ' + workflow_action_instruction + ' it.';
  default_task_instructions = 'A {artifactType} was ' + draft_verb + ' by §<USERID:{userId}>. Review this {artifactType} and then ' + workflow_action_instruction + ' it.';
  default_task_title = workflow_action + ' {artifactType} {artifactName}';
  execution.setTransientVariableLocal('one_or_many', 'one');
}
execution.setTransientVariableLocal('default_task_instructions', default_task_instructions);
execution.setTransientVariableLocal('default_task_title', default_task_title);
execution.setTransientVariableLocal('task_instructions', task_instructions);
// This is quite a hack to extract the user_id from the created_by string. TODO: modify InitArtifact.
execution.setTransientVariableLocal('created_by_user_id', created_by.substring(8,created_by.length-1));

scriptLogger.info(execution, execution.getProcessDefinitionId() + ': task ' + task_instructions);
execution.setTransientVariableLocal('approval_due_date', due_date);
execution.setVariable('action', null);
execution.setVariable('comment', null);
execution.setVariable('due_date', null);

var action_config = '';
if (publishing_step_mode == 'auto_action') {
	switch (execution.getVariable('draft_mode')) {
	    case 'DELETE':
		//actions #delete, -reject
		action_config = 'X-X#';
		break;
	    default:
		//actions #publish, -reject
		action_config = 'X-#X';
	}
} else {
	//only actions approve and -reject possible
	action_config = ' -XX';
}
execution.setTransientVariableLocal('action_config', action_config);
]]></script>
    </scriptTask>
    <userTask id="approval" name="Approval" flowable:dueDate="${approval_due_date}" flowable:category="approval" flowable:formFieldValidation="true">
      <documentation>{"id":"wkc-governance-workflows.default.approval.taskTitle.${draft_mode}.${one_or_many}", "defaultMessage":"${default_task_title}", "§artifactType":"wkc-governance-workflows.default.artifactType.${artifact_type}", "§artifactTypePlural":"wkc-governance-workflows.default.artifactType.${artifact_type}.plural", "artifactName":"${artifact_name}"} $$$ {"id":"wkc-governance-workflows.default.approval.taskInstructions.${draft_mode}.${one_or_many}", "defaultMessage":"${default_task_instructions}", "§artifactType":"wkc-governance-workflows.default.artifactType.${artifact_type}", "§artifactTypePlural":"wkc-governance-workflows.default.artifactType.${artifact_type}.plural", "artifactName":"${artifact_name}", "userId":"${created_by_user_id}"} $$$ {"id":"wkc-governance-workflows.default.approval.stepInstructions", "defaultMessage":"Mandatory step. Add at least one assignee to approve or reject artifacts."} $$$ {"id":"wkc-governance-workflows.default.approval.stepTitle", "defaultMessage":"Approval"}</documentation>
      <extensionElements>
        <flowable:formProperty id="action" type="enum" readable="false" required="true">
          <flowable:value id="approve" name="{&quot;id&quot;:&quot;wkc-governance-workflows.default.approval.actionButton.approve&quot;, &quot;defaultMessage&quot;:&quot;Approve&quot;}"></flowable:value>
          <flowable:value id="reject" name="{&quot;id&quot;:&quot;wkc-governance-workflows.default.approval.actionButton.reject&quot;, &quot;defaultMessage&quot;:&quot;Reject&quot;}"></flowable:value>
          <flowable:value id="publish" name="{&quot;id&quot;:&quot;wkc-governance-workflows.default.approval.actionButton.publish&quot;, &quot;defaultMessage&quot;:&quot;Publish&quot;}"></flowable:value>
          <flowable:value id="delete" name="{&quot;id&quot;:&quot;wkc-governance-workflows.default.approval.actionButton.delete&quot;, &quot;defaultMessage&quot;:&quot;Delete&quot;}"></flowable:value>
        </flowable:formProperty>
        <flowable:formProperty id="comment" type="string" readable="false"></flowable:formProperty>
        <flowable:formProperty id="due_date" type="date" readable="false"></flowable:formProperty>
      </extensionElements>
    </userTask>
    <exclusiveGateway id="exclusivegateway2" name="Excl. Gateway 2" default="sid-AC121BF7-B39F-4E43-94C2-806095B74BD6"></exclusiveGateway>
    <scriptTask id="scripttask4" name="Return to Draft state" scriptFormat="javascript" flowable:autoStoreVariables="false">
      <script><![CDATA[scriptLogger.info(execution, execution.getProcessDefinitionId() + ': action ' + action + ' comment ' + comment + ' due date ' + due_date);
var lockDraft = draft_mode === 'DELETE' ? true : false;
// workflowStateAndActionLogger.updateWorkflowState(execution, 'Rejected', '{"id":"wkc-governance-workflows.default.publishing.actionButton.reject", "defaultMessage":"Reject"}', lockDraft, comment, null);]]></script>
    </scriptTask>
    <sequenceFlow id="flow10" sourceRef="scripttask4" targetRef="scripttask10"></sequenceFlow>
    <exclusiveGateway id="exclusivegateway3" name="Excl. Gateway 3" default="publishFlow"></exclusiveGateway>
    <sequenceFlow id="flow11" sourceRef="callpublish" targetRef="exclusivegateway3"></sequenceFlow>
    <endEvent id="endevent3" name="End"></endEvent>
    <exclusiveGateway id="exclusivegateway4" name="Excl. Gateway 4" default="authoringFlow"></exclusiveGateway>
    <sequenceFlow id="flow12" sourceRef="callactivity1" targetRef="exclusivegateway4"></sequenceFlow>
    <sequenceFlow id="deleteFlow" name="delete" sourceRef="exclusivegateway4" targetRef="scripttask13">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${workflow_state == 'Marked for deletion'}]]></conditionExpression>
    </sequenceFlow>
    <boundaryEvent id="boundaryerror1" name="Error" attachedToRef="scripttask2">
      <errorEventDefinition></errorEventDefinition>
    </boundaryEvent>
    <sequenceFlow id="flow13" name="discard Failure" sourceRef="boundaryerror1" targetRef="scripttask12"></sequenceFlow>
    <scriptTask id="scripttask5" name="Cancel review" scriptFormat="javascript" flowable:autoStoreVariables="false">
      <script><![CDATA[var evSubsMgr = org.flowable.engine.impl.util.CommandContextUtil.getEventSubscriptionService();
var subList = evSubsMgr.findSignalEventSubscriptionsByProcessInstanceAndEventName(execution.getProcessInstanceId(), 'cancelReview');
for (var subIter = subList.iterator(); subIter.hasNext(); ) {
  var sub = subIter.next();
  scriptLogger.info(execution, 'canceling review task: Signal Event Subscription: executionId ' + sub.getExecutionId() + ' procInstId ' + sub.getProcessInstanceId() + ' type ' + sub.getEventType() + ' name ' + sub.getEventName());
  try {
    runtimeService.signalEventReceived('cancelReview', sub.getExecutionId());
  }
  catch (e) {
   	scriptLogger.error(execution, "Error canceling review: " + e);
  }
}
]]></script>
    </scriptTask>
    <scriptTask id="scripttask6" name="prep review" scriptFormat="javascript" flowable:autoStoreVariables="false">
      <script><![CDATA[execution.setTransientVariableLocal('workflow_action', 'Review');
var draft_verb_lookup = {'CREATE': 'created', 'MODIFY': 'updated', 'DELETE': 'marked for deletion', 'IMPORT_CREATE': 'imported', 'IMPORT_MODIFY': 'imported'};
var draft_verb = draft_verb_lookup[draft_mode] || draft_mode;
var task_instructions = null;
var default_task_instructions = null;
var default_task_title = null;
if (isPluralText) {
  task_instructions = task_context + ' and then provide a review comment.';
  default_task_instructions = '§<USERID:{userId}> ' + draft_verb + ' these {artifactTypePlural}. Review each {artifactType} and then provide a review comment.';
  default_task_title = workflow_action + ' {artifactTypePlural}';
  execution.setTransientVariableLocal('one_or_many', 'many');
} else {
  task_instructions = task_context + ' and then provide a review comment.';
  default_task_instructions = 'A {artifactType} was ' + draft_verb + ' by §<USERID:{userId}>. Review this {artifactType} and then provide a review comment.';
  default_task_title = workflow_action + ' {artifactType} {artifactName}';
  execution.setTransientVariableLocal('one_or_many', 'one');
}
execution.setTransientVariableLocal('default_task_instructions', default_task_instructions);
execution.setTransientVariableLocal('default_task_title', default_task_title);
execution.setTransientVariableLocal('task_instructions', task_instructions);
// This is quite a hack to extract the user_id from the created_by string. TODO: modify InitArtifact.
execution.setTransientVariableLocal('created_by_user_id', created_by.substring(8,created_by.length-1));

scriptLogger.info(execution, execution.getProcessDefinitionId() + ': task ' + task_instructions);
execution.setTransientVariableLocal('review_due_date', due_date);
execution.setVariable('action', null);
execution.setVariable('comment', null);
execution.setVariable('due_date', null);
]]></script>
    </scriptTask>
    <userTask id="review" name="Review" flowable:dueDate="${review_due_date}" flowable:category="review" flowable:formFieldValidation="true">
      <documentation>{"id":"wkc-governance-workflows.default.review.taskTitle.${draft_mode}.${one_or_many}", "defaultMessage":"${default_task_title}", "§artifactType":"wkc-governance-workflows.default.artifactType.${artifact_type}", "§artifactTypePlural":"wkc-governance-workflows.default.artifactType.${artifact_type}.plural", "artifactName":"${artifact_name}"} $$$ {"id":"wkc-governance-workflows.default.review.taskInstructions.${draft_mode}.${one_or_many}", "defaultMessage":"${default_task_instructions}", "§artifactType":"wkc-governance-workflows.default.artifactType.${artifact_type}", "§artifactTypePlural":"wkc-governance-workflows.default.artifactType.${artifact_type}.plural", "artifactName":"${artifact_name}", "userId":"${created_by_user_id}"} $$$ {"id":"wkc-governance-workflows.default.review.stepInstructions", "defaultMessage":"Optional step. Optionally add assignees to review artifacts."} $$$ {"id":"wkc-governance-workflows.default.review.stepTitle", "defaultMessage":"Review"}</documentation>
      <extensionElements>
        <flowable:formProperty id="action" type="enum" readable="false" required="true">
          <flowable:value id="reviewed" name="{&quot;id&quot;:&quot;wkc-governance-workflows.default.review.actionButton.reviewed&quot;, &quot;defaultMessage&quot;:&quot;Reviewed&quot;}"></flowable:value>
        </flowable:formProperty>
        <flowable:formProperty id="comment" type="string" readable="false" required="true"></flowable:formProperty>
      </extensionElements>
    </userTask>
    <sequenceFlow id="flow17" sourceRef="scripttask6" targetRef="review"></sequenceFlow>
    <scriptTask id="scripttask7" name="Store review" scriptFormat="javascript" flowable:autoStoreVariables="false">
      <script><![CDATA[scriptLogger.info(execution, execution.getProcessDefinitionId() + ': action ' + action + ' comment ' + comment);
// workflowStateAndActionLogger.updateWorkflowState(execution, workflow_state, '{"id":"wkc-governance-workflows.default.review.actionButton.reviewed", "defaultMessage":"Reviewed"}', true, comment, null);
]]></script>
    </scriptTask>
    <sequenceFlow id="flow18" sourceRef="review" targetRef="scripttask7"></sequenceFlow>
    <sequenceFlow id="flow19" sourceRef="scripttask7" targetRef="scripttask6"></sequenceFlow>
    <boundaryEvent id="boundarysignal1" name="Signal" attachedToRef="review" cancelActivity="true">
      <signalEventDefinition signalRef="cancelReview"></signalEventDefinition>
    </boundaryEvent>
    <scriptTask id="scripttask8" name="Log Cancel" scriptFormat="javascript" flowable:autoStoreVariables="false">
      <script><![CDATA[scriptLogger.info(execution, 'Canceled Review user task.');
]]></script>
    </scriptTask>
    <sequenceFlow id="flow20" name="canceled review" sourceRef="boundarysignal1" targetRef="scripttask8"></sequenceFlow>
    <endEvent id="endevent5" name="End"></endEvent>
    <sequenceFlow id="flow21" sourceRef="scripttask8" targetRef="endevent5"></sequenceFlow>
    <scriptTask id="scripttask9" name="init State" scriptFormat="javascript" flowable:autoStoreVariables="false">
      <script><![CDATA[scriptLogger.info(execution, execution.getProcessDefinitionId() + " procInstId " + execution.getProcessInstanceId());
var artifact = managedArtifactsBean.getArtifactByIndex(execution, 0);
var draft_mode = 'unknown mode';
if (artifact != null) {
  var draftMode =  artifact.getWorkflow_data().getDraft_mode();
  if (draftMode != null) {
    draft_mode = draftMode.value();
  }
}
execution.setVariable('draft_mode', draft_mode);

var newState = 'Not started';
switch (draft_mode) {
    case 'marked_for_deletion':
    case 'MARKED_FOR_DELETION':
    case 'DELETE':
      newState = 'Marked for deletion';
      execution.setVariable('due_date', null);
      execution.setVariable('review_due_date', null);
      break;
}
// WORKFLOW_STATE: 'Not started'
// WORKFLOW_STATE: 'Marked for deletion'
// workflowStateAndActionLogger.updateInternalWorkflowState(execution, newState);
]]></script>
    </scriptTask>
    <sequenceFlow id="flow22" sourceRef="scripttask9" targetRef="callactivity1"></sequenceFlow>
    <scriptTask id="scripttask10" name="prep authoring" scriptFormat="javascript" flowable:autoStoreVariables="false">
      <script><![CDATA[execution.setTransientVariableLocal('workflow_action', 'Send for Approval');
var task_instructions = null;
if (isPluralText) {
  task_instructions = task_context + ' and then send for approval or delete all of them together.';
  execution.setTransientVariableLocal('one_or_many', 'many');
} else {
  task_instructions = task_context + ' and then send for approval or delete it.';
  execution.setTransientVariableLocal('one_or_many', 'one');
}
execution.setTransientVariableLocal('task_instructions', task_instructions);
// This is quite a hack to extract the user_id from the created_by string. TODO: modify InitArtifact.
execution.setTransientVariableLocal('created_by_user_id', created_by.substring(8,created_by.length-1));

scriptLogger.info(execution, execution.getProcessDefinitionId() + ': task ' + task_instructions);
execution.setVariable('action', null);
execution.setVariable('comment', null);
execution.setVariable('due_date', null);
]]></script>
    </scriptTask>
    <sequenceFlow id="flow23" sourceRef="scripttask10" targetRef="callactivity2"></sequenceFlow>
    <scriptTask id="scripttask11" name="ready for approval state" scriptFormat="javascript" flowable:autoStoreVariables="false">
      <script><![CDATA[scriptLogger.info(execution, execution.getProcessDefinitionId() + ': action ' + action + ' comment ' + comment + ' due date ' + due_date);
// workflowStateAndActionLogger.updateWorkflowState(execution, 'Ready for approval', '{"id":"wkc-governance-workflows.default.authoring.actionButton.sendforapproval", "defaultMessage":"Send for approval"}', true, comment, null);


]]></script>
    </scriptTask>
    <scriptTask id="scripttask12" name="Discard failed state" scriptFormat="javascript" flowable:autoStoreVariables="false">
      <script><![CDATA[scriptLogger.info(execution, execution.getProcessDefinitionId() + ': discard failed!');
// workflowStateAndActionLogger.updateWorkflowState(execution, 'Discard failed', '{"id":"wkc-governance-workflows.default.workflowState.Discard failed", "defaultMessage":"Discard failed"}', false, null, null);
]]></script>
    </scriptTask>
    <sequenceFlow id="flow25" sourceRef="scripttask12" targetRef="callactivity1"></sequenceFlow>
    <sequenceFlow id="flowToInitArtifact" name="updated artifact" sourceRef="exclusivegateway5" targetRef="callactivity1">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${artifact_may_have_changed == true}]]></conditionExpression>
    </sequenceFlow>
    <callActivity id="callactivity1" name="init Artifact" calledElement="initArtifact" flowable:calledElementType="key" flowable:fallbackToDefaultTenant="false"></callActivity>
    <scriptTask id="scripttask13" name="join flows" scriptFormat="javascript" flowable:autoStoreVariables="false">
      <script><![CDATA[scriptLogger.info(execution, 'Lauching approval and review user tasks. workflow_state=' + workflow_state);
]]></script>
    </scriptTask>
    <sequenceFlow id="flow27" sourceRef="scripttask11" targetRef="scripttask13"></sequenceFlow>
    <parallelGateway id="parallelgateway1" name="Parallel Gateway"></parallelGateway>
    <sequenceFlow id="flow30" sourceRef="scripttask13" targetRef="parallelgateway1"></sequenceFlow>
    <sequenceFlow id="flow31" sourceRef="parallelgateway1" targetRef="scripttask3"></sequenceFlow>
    <callActivity id="callactivity2" name="authoring" calledElement="authoringForApprovalGlobalized" flowable:calledElementType="key" flowable:fallbackToDefaultTenant="false">
      <extensionElements>
        <flowable:in source="artifact_type" target="artifact_type"></flowable:in>
        <flowable:in source="artifact_name" target="artifact_name"></flowable:in>
        <flowable:in source="draft_mode" target="draft_mode"></flowable:in>
        <flowable:in source="one_or_many" target="one_or_many"></flowable:in>
        <flowable:in source="created_by_user_id" target="created_by_user_id"></flowable:in>
        <flowable:in source="isPluralText" target="isPluralText"></flowable:in>
        <flowable:out source="action" target="action"></flowable:out>
        <flowable:out source="comment" target="comment"></flowable:out>
        <flowable:out source="due_date" target="due_date"></flowable:out>
        <flowable:out source="artifact_may_have_changed" target="artifact_may_have_changed"></flowable:out>
        <flowable:out source="cancel_workflow" target="cancel_workflow"></flowable:out>
      </extensionElements>
    </callActivity>
    <exclusiveGateway id="exclusivegateway5" name="Excl. Gateway 5" default="flowToApproval"></exclusiveGateway>
    <sequenceFlow id="flow33" sourceRef="callactivity2" targetRef="exclusivegateway5"></sequenceFlow>
    <sequenceFlow id="flowToApproval" sourceRef="exclusivegateway5" targetRef="exclusivegateway1"></sequenceFlow>
    <sequenceFlow id="flowToCancelWorkflow" name="cancel workflow" sourceRef="exclusivegateway5" targetRef="endevent2">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${cancel_workflow == true}]]></conditionExpression>
    </sequenceFlow>
    <exclusiveGateway id="exclusivegateway6" name="Excl. Gateway 6" default="flow103"></exclusiveGateway>
    <userTask id="approval_2" name="Approval 2" flowable:dueDate="${approval_due_date}" flowable:category="approval" flowable:formFieldValidation="true">
      <documentation>Approve by Finance $$$Review this document and then approve or reject it.$$$Add at least one assignee to approve or reject artifacts.$$$Approval (fiscal)</documentation>
      <extensionElements>
        <flowable:formProperty id="comment" type="string"></flowable:formProperty>
        <flowable:formProperty id="due_date" type="date" datePattern="MM-dd-yyyy hh:mm"></flowable:formProperty>
        <flowable:formProperty id="action" type="enum" required="true">
          <flowable:value id="approve" name="Approve"></flowable:value>
          <flowable:value id="reject" name="Reject"></flowable:value>
          <flowable:value id="publish" name="Publish"></flowable:value>
          <flowable:value id="delete" name="Delete"></flowable:value>
        </flowable:formProperty>
      </extensionElements>
    </userTask>
    <sequenceFlow id="flow32" sourceRef="parallelgateway1" targetRef="scripttask6"></sequenceFlow>
    <sequenceFlow id="flow8" sourceRef="scripttask3" targetRef="approval"></sequenceFlow>
    <sequenceFlow id="publishRejectFlow" name="reject" sourceRef="exclusivegateway3" targetRef="scripttask4">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${action == 'reject'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="publishFlow" name="publish" sourceRef="exclusivegateway3" targetRef="endevent3"></sequenceFlow>
    <sequenceFlow id="flow100" sourceRef="approval" targetRef="exclusivegateway6"></sequenceFlow>
    <sequenceFlow id="flow104" name="approve" sourceRef="approval_2" targetRef="scripttask5"></sequenceFlow>
    <scriptTask id="prep_approval_2" name="prep approval 2" flowable:autoStoreVariables="false">
      <script><![CDATA[scriptLogger.info(execution, execution.getProcessDefinitionId() + ': action ' + action + ' comment ' + comment + ' due date ' + due_date);
// workflowStateAndActionLogger.updateWorkflowState(execution, 'Ready for 2nd approval', 'Approve', true, comment, null);

// make a copy of the due_date so the due date of review task can be set properly,
// this is required as the due_date will be set to null later so there is no initial value
// of the form property due_date for Approval 2 task.
// it has to be set as process variable instead of transient local variable as the new
// Review task is in a different execution and cannot read transient local variable created
// in current execution.
execution.setVariable('review_due_date', due_date);

execution.setTransientVariableLocal('workflow_action', 'Approve');
var workflow_action_instruction = 'approve or reject';
var draft_verb_lookup = {'CREATE': 'created', 'MODIFY': 'updated', 'DELETE': 'marked for deletion', 'IMPORT_CREATE': 'imported', 'IMPORT_MODIFY': 'imported'};
var draft_verb = draft_verb_lookup[draft_mode] || draft_mode;
var task_instructions = null;
var default_task_instructions = null;
var default_task_title = null;
if (isPluralText) {
  task_instructions = task_context + ' and then ' + workflow_action_instruction + ' all of them together.';
  default_task_instructions = '§<USERID:{userId}> ' + draft_verb + ' these {artifactTypePlural}. Review each {artifactType} and then ' + workflow_action_instruction + ' all of them together.';
  default_task_title = workflow_action + ' {artifactTypePlural}';
  execution.setTransientVariableLocal('one_or_many', 'many');
} else {
  task_instructions = task_context + ' and then ' + workflow_action_instruction + ' it.';
  default_task_instructions = 'A {artifactType} was ' + draft_verb + ' by §<USERID:{userId}>. Review this {artifactType} and then ' + workflow_action_instruction + ' it.';
  default_task_title = workflow_action + ' {artifactType} {artifactName}';
  execution.setTransientVariableLocal('one_or_many', 'one');
}
execution.setTransientVariableLocal('default_task_instructions', default_task_instructions);
execution.setTransientVariableLocal('default_task_title', default_task_title);
execution.setTransientVariableLocal('task_instructions', task_instructions);
// This is quite a hack to extract the user_id from the created_by string. TODO: modify InitArtifact.
execution.setTransientVariableLocal('created_by_user_id', created_by.substring(8,created_by.length-1));

scriptLogger.info(execution, execution.getProcessDefinitionId() + ': task ' + task_instructions);
execution.setTransientVariableLocal('approval_due_date', due_date);
execution.setVariable('action', null);
execution.setVariable('comment', null);
execution.setVariable('due_date', null);

var action_config = '';
if (publishing_step_mode == 'auto_action') {
	switch (execution.getVariable('draft_mode')) {
	    case 'DELETE':
		//actions #delete, -reject
		action_config = 'X-X#';
		break;
	    default:
		//actions #publish, -reject
		action_config = 'X-#X';
	}
} else {
	//only actions approve and -reject possible
	action_config = ' -XX';
}
execution.setTransientVariableLocal('action_config', action_config);]]></script>
    </scriptTask>
    <sequenceFlow id="sid-60C21C6E-183B-4896-85DD-D075EB2DF387" sourceRef="scripttask5" targetRef="exclusivegateway2"></sequenceFlow>
    <sequenceFlow id="sid-AC121BF7-B39F-4E43-94C2-806095B74BD6" sourceRef="exclusivegateway2" targetRef="scripttask4"></sequenceFlow>
    <sequenceFlow id="flow111" sourceRef="prep_approval_2" targetRef="approval_2"></sequenceFlow>
    <sequenceFlow id="flow103" name="reject" sourceRef="exclusivegateway6" targetRef="scripttask5"></sequenceFlow>
    <sequenceFlow id="approveFlow" name="approve" sourceRef="exclusivegateway2" targetRef="callpublish">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${action == 'approve' || action == 'publish' || action == 'delete'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow110" sourceRef="exclusivegateway6" targetRef="prep_approval_2">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${action == 'approve' || action == 'publish' || action == 'delete'}]]></conditionExpression>
    </sequenceFlow>
  </process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_affie_v6_two_step_approval_and_review_key">
    <bpmndi:BPMNPlane bpmnElement="affie_v6_two_step_approval_and_review_key" id="BPMNPlane_affie_v6_two_step_approval_and_review_key">
      <bpmndi:BPMNShape bpmnElement="startevent1" id="BPMNShape_startevent1">
        <omgdc:Bounds height="30.0" width="30.0" x="33.0" y="40.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway1" id="BPMNShape_exclusivegateway1">
        <omgdc:Bounds height="40.0" width="40.0" x="304.0" y="388.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="callpublish" id="BPMNShape_callpublish">
        <omgdc:Bounds height="55.0" width="105.0" x="1020.0" y="505.5"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="endevent2" id="BPMNShape_endevent2">
        <omgdc:Bounds height="28.0" width="28.0" x="147.0" y="519.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="scripttask2" id="BPMNShape_scripttask2">
        <omgdc:Bounds height="55.0" width="105.0" x="112.0" y="381.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="scripttask3" id="BPMNShape_scripttask3">
        <omgdc:Bounds height="55.0" width="105.0" x="586.0" y="120.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="approval" id="BPMNShape_approval">
        <omgdc:Bounds height="55.0" width="105.0" x="765.0" y="120.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway2" id="BPMNShape_exclusivegateway2">
        <omgdc:Bounds height="40.0" width="40.0" x="1052.5" y="420.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="scripttask4" id="BPMNShape_scripttask4">
        <omgdc:Bounds height="55.0" width="105.0" x="450.0" y="58.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway3" id="BPMNShape_exclusivegateway3">
        <omgdc:Bounds height="40.0" width="40.0" x="1155.0" y="513.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="endevent3" id="BPMNShape_endevent3">
        <omgdc:Bounds height="28.0" width="28.0" x="1161.0" y="615.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway4" id="BPMNShape_exclusivegateway4">
        <omgdc:Bounds height="40.0" width="40.0" x="304.0" y="65.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="boundaryerror1" id="BPMNShape_boundaryerror1">
        <omgdc:Bounds height="30.0" width="30.0" x="97.0" y="400.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="scripttask5" id="BPMNShape_scripttask5">
        <omgdc:Bounds height="55.0" width="105.0" x="1020.0" y="330.5"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="scripttask6" id="BPMNShape_scripttask6">
        <omgdc:Bounds height="55.0" width="105.0" x="586.0" y="381.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="review" id="BPMNShape_review">
        <omgdc:Bounds height="55.0" width="105.0" x="586.0" y="492.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="scripttask7" id="BPMNShape_scripttask7">
        <omgdc:Bounds height="55.0" width="105.0" x="732.5" y="492.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="boundarysignal1" id="BPMNShape_boundarysignal1">
        <omgdc:Bounds height="30.0" width="30.0" x="646.0" y="542.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="scripttask8" id="BPMNShape_scripttask8">
        <omgdc:Bounds height="55.0" width="105.0" x="608.0" y="620.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="endevent5" id="BPMNShape_endevent5">
        <omgdc:Bounds height="28.0" width="28.0" x="771.0" y="630.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="scripttask9" id="BPMNShape_scripttask9">
        <omgdc:Bounds height="55.0" width="105.0" x="112.0" y="30.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="scripttask10" id="BPMNShape_scripttask10">
        <omgdc:Bounds height="55.0" width="105.0" x="272.0" y="140.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="scripttask11" id="BPMNShape_scripttask11">
        <omgdc:Bounds height="55.0" width="105.0" x="430.0" y="381.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="scripttask12" id="BPMNShape_scripttask12">
        <omgdc:Bounds height="55.0" width="105.0" x="17.0" y="280.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="callactivity1" id="BPMNShape_callactivity1">
        <omgdc:Bounds height="55.0" width="105.0" x="112.0" y="140.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="scripttask13" id="BPMNShape_scripttask13">
        <omgdc:Bounds height="55.0" width="105.0" x="430.0" y="196.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="parallelgateway1" id="BPMNShape_parallelgateway1">
        <omgdc:Bounds height="40.0" width="40.0" x="545.0" y="287.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="callactivity2" id="BPMNShape_callactivity2">
        <omgdc:Bounds height="55.0" width="105.0" x="272.0" y="224.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway5" id="BPMNShape_exclusivegateway5">
        <omgdc:Bounds height="40.0" width="40.0" x="304.0" y="308.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway6" id="BPMNShape_exclusivegateway6">
        <omgdc:Bounds height="40.0" width="40.0" x="797.5" y="203.5"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="approval_2" id="BPMNShape_approval_2">
        <omgdc:Bounds height="56.0" width="95.0" x="885.0" y="330.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="prep_approval_2" id="BPMNShape_prep_approval_2">
        <omgdc:Bounds height="40.0" width="108.5" x="765.0" y="287.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge bpmnElement="sendforapprovalFlow" id="BPMNEdge_sendforapprovalFlow">
        <omgdi:waypoint x="343.88103394090615" y="408.0627358490567"></omgdi:waypoint>
        <omgdi:waypoint x="429.99999999998977" y="408.33438485804413"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow25" id="BPMNEdge_flow25">
        <omgdi:waypoint x="88.1267857142857" y="280.0"></omgdi:waypoint>
        <omgdi:waypoint x="145.83928571428572" y="194.95000000000002"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow27" id="BPMNEdge_flow27">
        <omgdi:waypoint x="482.5" y="381.0"></omgdi:waypoint>
        <omgdi:waypoint x="482.5" y="250.95000000000002"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="publishFlow" id="BPMNEdge_publishFlow">
        <omgdi:waypoint x="1175.0" y="552.9396201873049"></omgdi:waypoint>
        <omgdi:waypoint x="1175.0" y="615.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-AC121BF7-B39F-4E43-94C2-806095B74BD6" id="BPMNEdge_sid-AC121BF7-B39F-4E43-94C2-806095B74BD6">
        <omgdi:waypoint x="1092.4382092197454" y="440.0"></omgdi:waypoint>
        <omgdi:waypoint x="1157.0" y="440.0"></omgdi:waypoint>
        <omgdi:waypoint x="1157.0" y="99.0"></omgdi:waypoint>
        <omgdi:waypoint x="554.95" y="86.5818563789152"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flowToApproval" id="BPMNEdge_flowToApproval">
        <omgdi:waypoint x="324.0" y="347.9375468164794"></omgdi:waypoint>
        <omgdi:waypoint x="324.0" y="388.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="publishRejectFlow" id="BPMNEdge_publishRejectFlow">
        <omgdi:waypoint x="1175.0" y="513.0"></omgdi:waypoint>
        <omgdi:waypoint x="1175.0" y="85.0"></omgdi:waypoint>
        <omgdi:waypoint x="554.9499999999881" y="85.46096654275092"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow5" id="BPMNEdge_flow5">
        <omgdi:waypoint x="62.94649418941021" y="55.320743202623305"></omgdi:waypoint>
        <omgdi:waypoint x="111.99999999999997" y="56.37339055793991"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow6" id="BPMNEdge_flow6">
        <omgdi:waypoint x="163.72690763052208" y="435.95"></omgdi:waypoint>
        <omgdi:waypoint x="161.39201679073543" y="519.005422079355"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow20" id="BPMNEdge_flow20">
        <omgdi:waypoint x="660.9171283099837" y="571.9497766399762"></omgdi:waypoint>
        <omgdi:waypoint x="660.6516574585636" y="620.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow21" id="BPMNEdge_flow21">
        <omgdi:waypoint x="712.9499999999988" y="646.0240963855422"></omgdi:waypoint>
        <omgdi:waypoint x="771.0054194588192" y="644.3920169714602"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow100" id="BPMNEdge_flow100">
        <omgdi:waypoint x="817.5" y="174.95"></omgdi:waypoint>
        <omgdi:waypoint x="817.5" y="203.5"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow22" id="BPMNEdge_flow22">
        <omgdi:waypoint x="164.5" y="84.95"></omgdi:waypoint>
        <omgdi:waypoint x="164.5" y="140.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow8" id="BPMNEdge_flow8">
        <omgdi:waypoint x="690.9499999999967" y="147.5"></omgdi:waypoint>
        <omgdi:waypoint x="764.999999999914" y="147.5"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow23" id="BPMNEdge_flow23">
        <omgdi:waypoint x="324.5" y="194.95000000000002"></omgdi:waypoint>
        <omgdi:waypoint x="324.5" y="224.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flowToCancelWorkflow" id="BPMNEdge_flowToCancelWorkflow">
        <omgdi:waypoint x="315.14130434782606" y="339.1134510869565"></omgdi:waypoint>
        <omgdi:waypoint x="169.682313571016" y="522.0413879702417"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow103" id="BPMNEdge_flow103">
        <omgdi:waypoint x="837.410882352941" y="223.4607843137255"></omgdi:waypoint>
        <omgdi:waypoint x="1072.0" y="223.0"></omgdi:waypoint>
        <omgdi:waypoint x="1072.398148148148" y="330.5"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow104" id="BPMNEdge_flow104">
        <omgdi:waypoint x="979.9499999999999" y="358.0"></omgdi:waypoint>
        <omgdi:waypoint x="1020.0" y="358.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="deleteFlow" id="BPMNEdge_deleteFlow">
        <omgdi:waypoint x="334.64649108044426" y="94.30328282828285"></omgdi:waypoint>
        <omgdi:waypoint x="451.0230963551065" y="196.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow17" id="BPMNEdge_flow17">
        <omgdi:waypoint x="638.5" y="435.95"></omgdi:waypoint>
        <omgdi:waypoint x="638.5" y="492.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow18" id="BPMNEdge_flow18">
        <omgdi:waypoint x="690.9499999999999" y="519.5"></omgdi:waypoint>
        <omgdi:waypoint x="732.499999999869" y="519.5"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow19" id="BPMNEdge_flow19">
        <omgdi:waypoint x="785.0" y="492.0"></omgdi:waypoint>
        <omgdi:waypoint x="785.0" y="408.0"></omgdi:waypoint>
        <omgdi:waypoint x="690.9499999999936" y="408.32081911262793"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flowToInitArtifact" id="BPMNEdge_flowToInitArtifact">
        <omgdi:waypoint x="304.11808576754777" y="327.87577639751555"></omgdi:waypoint>
        <omgdi:waypoint x="164.0" y="327.0"></omgdi:waypoint>
        <omgdi:waypoint x="164.41379310344828" y="194.95000000000002"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow13" id="BPMNEdge_flow13">
        <omgdi:waypoint x="97.00359506676473" y="414.65125521797125"></omgdi:waypoint>
        <omgdi:waypoint x="69.0" y="414.0"></omgdi:waypoint>
        <omgdi:waypoint x="69.37089201877934" y="334.95"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="authoringFlow" id="BPMNEdge_authoringFlow">
        <omgdi:waypoint x="324.1201807228916" y="104.81796028880865"></omgdi:waypoint>
        <omgdi:waypoint x="324.3333333333333" y="140.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="discardflow" id="BPMNEdge_discardflow">
        <omgdi:waypoint x="304.0625" y="408.06234375"></omgdi:waypoint>
        <omgdi:waypoint x="216.94999999999544" y="408.33542319749216"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow31" id="BPMNEdge_flow31">
        <omgdi:waypoint x="571.2932403433476" y="293.30901287553644"></omgdi:waypoint>
        <omgdi:waypoint x="625.8275862068965" y="174.95"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow110" id="BPMNEdge_flow110">
        <omgdi:waypoint x="817.6882075471698" y="243.24336158192094"></omgdi:waypoint>
        <omgdi:waypoint x="818.0" y="276.0"></omgdi:waypoint>
        <omgdi:waypoint x="818.4435483870968" y="287.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow10" id="BPMNEdge_flow10">
        <omgdi:waypoint x="450.0" y="109.66235955056179"></omgdi:waypoint>
        <omgdi:waypoint x="376.95000000000005" y="143.31460674157304"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow32" id="BPMNEdge_flow32">
        <omgdi:waypoint x="573.3789999999999" y="318.5700885208452"></omgdi:waypoint>
        <omgdi:waypoint x="618.5862068965517" y="381.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow111" id="BPMNEdge_flow111">
        <omgdi:waypoint x="819.1519607843137" y="326.95"></omgdi:waypoint>
        <omgdi:waypoint x="819.0" y="358.0"></omgdi:waypoint>
        <omgdi:waypoint x="885.0" y="358.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow11" id="BPMNEdge_flow11">
        <omgdi:waypoint x="1124.95" y="533.0"></omgdi:waypoint>
        <omgdi:waypoint x="1155.0" y="533.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow33" id="BPMNEdge_flow33">
        <omgdi:waypoint x="324.32026143790847" y="278.95"></omgdi:waypoint>
        <omgdi:waypoint x="324.12954545454545" y="308.1298701298701"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow12" id="BPMNEdge_flow12">
        <omgdi:waypoint x="216.94999999999993" y="140.3448275862069"></omgdi:waypoint>
        <omgdi:waypoint x="310.8181818181818" y="91.80113636363636"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-60C21C6E-183B-4896-85DD-D075EB2DF387" id="BPMNEdge_sid-60C21C6E-183B-4896-85DD-D075EB2DF387">
        <omgdi:waypoint x="1072.5" y="385.45"></omgdi:waypoint>
        <omgdi:waypoint x="1072.5" y="420.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="approveFlow" id="BPMNEdge_approveFlow">
        <omgdi:waypoint x="1072.5" y="459.93928571428575"></omgdi:waypoint>
        <omgdi:waypoint x="1072.5" y="505.5"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow30" id="BPMNEdge_flow30">
        <omgdi:waypoint x="509.62125748502996" y="250.95000000000002"></omgdi:waypoint>
        <omgdi:waypoint x="555.0602409638554" y="296.9394942805539"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</definitions>